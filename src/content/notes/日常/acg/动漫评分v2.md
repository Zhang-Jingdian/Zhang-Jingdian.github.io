# 评分公式（0–10 制）

---

## 1) 符号约定

- 子项打分（0–10）：视觉 `V`、音效 `S`、风格 `T`（style）  
    人物 `C`（characters）、剧情 `P`（plot）、世界观 `W`  
    创新 `O`（originality）、体验 `E`（enjoyment）
    
- 形（Form） = `F`，神（Substance） = `U`（use U 表示 substance）
    
- 总体权重：`w_f`（form）、`w_u`（substance）、`w_o`（originality）、`w_e`（enjoyment）  
    建议：`w_f + w_u + w_o + w_e = 1`。默认（movie）：`w_f=0.35, w_u=0.45, w_o=0.10, w_e=0.10`。
    
- 形内部权重：`a_v, a_s, a_t` （总和 = 1）  
    默认：`a_v=0.5, a_s=0.2, a_t=0.3`。
    
- 神内部权重：`b_c, b_p, b_w` （总和 = 1）  
    默认：`b_c=0.4, b_p=0.35, b_w=0.25`。
    
- `clamp(x,0,10)` 表示把 x 限制到 [0,10]。
    
- 评审样本数 `n`，评审得到的 Base 分列表 `B_i`（i=1..n），评审权重（可信度） `r_i`（可选）。
    

---

## 2) 子层计算（形 / 神）

```
F = a_v*V + a_s*S + a_t*T
U = b_c*C + b_p*P + b_w*W
```

（结果在 0–10 范围，若输入在 0–10，则 F,U 自然在 0–10）

---

## 3) 基础总分（Base, 0–10）

```
Base = clamp( w_f * F + w_u * U + w_o * O + w_e * E , 0, 10 )
```

---

## 4) 不确定度 δ（置信区间宽度的一半） — 动态计算（推荐）

- 先设先验 `δ_prior`（单评审情形用经验值，例如 0.75）。
    
- 若有 ≥2 位评审并给出各自 Base 分 `B_i`（或你可用各评审计算得到的 base），先计算（加权）总体方差 `σ²`：
    
    - 无权重：均值 `μ = (1/n) Σ B_i`，总体方差 `σ² = (1/n) Σ (B_i − μ)²`。
        
    - 有权重 r_i：加权均值 `μ = (Σ r_i B_i)/(Σ r_i)`，加权方差 `σ² = (Σ r_i (B_i − μ)²)/(Σ r_i)`。
        
- 样本驱动的 δ： `δ_sample = 1.96 * σ`（95% 置信区间半宽）。
    
- 收缩（shrink）权重：`s = min(1, (n−1)/(n+4))`（简单启发式，n 越大越信样本）
    
- 最终 δ（带收缩）：
    

```
δ = clamp( δ_prior * (1−s) + δ_sample * s , δ_min, δ_max )
```

- 推荐常数：`δ_prior = 0.75`，`δ_min = 0.4`，`δ_max = 2.0`。（可按项目调整）
    

---

## 5) 最终置信区间 & 输出

```
Lower = clamp(Base − δ, 0, 10)
Upper = clamp(Base + δ, 0, 10)
Interval = [Lower, Upper]
```

同时输出：`Base`（主分数），`Interval`（置信区间），`δ`（半宽）。

---

## 6) 等级与星级

- 等级（示例映射）：
    
    - `Base ≥ 9.0` → 杰作 (A+)
        
    - `8.0 ≤ Base < 9.0` → 优秀 (A)
        
    - `7.0 ≤ Base < 8.0` → 良好 (B)
        
    - `6.0 ≤ Base < 7.0` → 及格 (C)
        
    - `Base < 6.0` → 不及格 (D/F)
        
- 星级（5 星制）：`stars = round(Base / 2, 1)`
    

---

## 7) 优先改进项

计算每个子项到满分的差距 `gap_X = 10 − X`，按 gap 降序取前 1–3 项作为 “优先提升” 建议（越大优先级越高）。

---

## 8) 模板快速参考

- **movie（默认）**：`w_f=0.35, w_u=0.45, w_o=0.10, w_e=0.10`  
    `a_v=0.5, a_s=0.2, a_t=0.3`；`b_c=0.4, b_p=0.35, b_w=0.25`。
    
- **anime**：视觉更重 `a_v≈0.55`，`w_f≈0.36, w_u≈0.44`。
    
- **comic**：`a_v≈0.7, a_s=0.0, a_t≈0.3`（无音效）。
    
- **novel**：更重内核 `w_f≈0.25, w_u≈0.55`，文字风格替代视觉。  
    （把这些写成速查表便于笔记）
    

---

## 9) 校准权重

若你有若干带“目标评分”的样本 `(ratings_j, target_j)`，可对总体权重 `w = (w_f, w_u, w_o, w_e)` 做最小二乘校准（最小化 MSE）并归一化非负约束。

> 简要方法：坐标下降（coordinate descent）或凸优化（带约束）：

- 初始取模板权重；循环对每个权重做小幅增减并归一化；若 MSE 降低则接受；迭代直到收敛。
    
- 校准后把新权重写入模板，后续打分使用校准后的权重。
    

---

## 10) 计算顺序

1. 取对应模板权重与子权重。
    
2. 填子项分数 `V,S,T,C,P,W,O,E`（0–10）。
    
3. 计算 `F` 与 `U`：`F = a_v V + a_s S + a_t T`；`U = b_c C + b_p P + b_w W`。
    
4. 计算 `Base = clamp(w_f*F + w_u*U + w_o*O + w_e*E, 0,10)`。
    
5. 若有多评审，计算 `σ` → `δ_sample = 1.96σ` → `s=(n−1)/(n+4)` → `δ = shrink(prior, sample, s)`；否则 `δ = δ_prior`（默认 0.75）。
    
6. 计算区间 `[Base−δ, Base+δ]` 并 clamp。
    
7. 输出 `Base`、`Interval`、`等级`、`星级`、`优先提升项`。
    

---

## 例子

已知：`V=8.5, S=7.0, T=9.2, C=7.8, P=6.5, W=8.0, O=7.5, E=8.8`，用默认 movie 模板与 `δ_prior=0.75`：

- `F = 0.5*8.5 + 0.2*7.0 + 0.3*9.2 = 8.41`
    
- `U = 0.4*7.8 + 0.35*6.5 + 0.25*8.0 = 7.395`
    
- `Base = 0.35*8.41 + 0.45*7.395 + 0.10*7.5 + 0.10*8.8 = 7.901`（≈7.90/10）
    
- 单评审 δ = 0.75 → Interval ≈ `[7.151, 8.651]`。
    
